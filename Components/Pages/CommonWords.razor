@page "/commonwords"
@using Plugin.Maui.Audio
@inject IAudioManager AudioManager

<div class="bg-black min-h-screen">
    <h1 class="pt-8 md:pt-10 text-center text-white text-3xl md:text-6xl font-serif">Common Words</h1>
    
    <div class="flex flex-col items-start pt-4 md:pt-6 ml-8 md:ml-36">
        @foreach (var word in _commonWords)
        {
            <button class="text-white text-xl md:text-6xl landscape:text-4xl p-3 se:p-2 md:p-4 font-serif" @onclick="() => PlayAudio(word.Value)">
                @word.Key - <u>@word.Value</u>
            </button>
        }
    </div>
    
    <div class="text-center pt-4 space-x-6">
        <button class="text-white" @onclick="() => _commonWords = _greetings">
            <svg class="w-6 h-6 md:w-12 md:h-12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M13.5 3C13.2239 3 13 3.22386 13 3.5V12C13 12.5523 12.5523 13 12 13C11.4477 13 11 12.5523 11 12V5.5C11 5.22386 10.7761 5 10.5 5C10.2239 5 9.99999 5.22386 9.99999 5.5V13.9677C9.99999 15.0757 8.62655 15.5918 7.8969 14.7579L5.34951 11.8466C5.19167 11.6662 4.95459 11.576 4.71675 11.6057C4.15329 11.6761 3.88804 12.3395 4.24762 12.779L8.93807 18.5118C10.2266 20.0867 12.154 21 14.1888 21C17.3982 21 20 18.3982 20 15.1888V7.5C20 7.22386 19.7761 7 19.5 7C19.2239 7 19 7.22386 19 7.5V12C19 12.5523 18.5523 13 18 13C17.4477 13 17 12.5523 17 12V5.5C17 5.22386 16.7761 5 16.5 5C16.2239 5 16 5.22386 16 5.5V12C16 12.5523 15.5523 13 15 13C14.4477 13 14 12.5523 14 12V3.5C14 3.22386 13.7761 3 13.5 3ZM15.9611 3.05823C15.7525 1.88823 14.73 1 13.5 1C12.27 1 11.2475 1.88823 11.0389 3.05823C10.8653 3.0201 10.685 3 10.5 3C9.11928 3 7.99999 4.11929 7.99999 5.5V11.8386L6.85467 10.5296C6.2595 9.84942 5.36551 9.50903 4.46868 9.62113C2.34401 9.88672 1.34381 12.3883 2.6997 14.0455L7.39016 19.7783C9.05854 21.8174 11.5541 23 14.1888 23C18.5028 23 22 19.5028 22 15.1888V7.5C22 6.11929 20.8807 5 19.5 5C19.315 5 19.1347 5.0201 18.9611 5.05823C18.7525 3.88823 17.73 3 16.5 3C16.315 3 16.1347 3.0201 15.9611 3.05823Z" fill="#ffffff"></path> </g></svg>
        </button>
        <button class="text-white" @onclick="() => _commonWords = _numbers">
            <svg class="w-6 h-6 md:w-12 md:h-12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M21 0C20.4477 0 20 0.447715 20 1V2H19C18.4477 2 18 2.44772 18 3C18 3.55228 18.4477 4 19 4H20V5C20 5.55228 20.4477 6 21 6C21.5523 6 22 5.55228 22 5V4H23C23.5523 4 24 3.55228 24 3C24 2.44772 23.5523 2 23 2H22V1C22 0.447715 21.5523 0 21 0Z" fill="#ffffff"></path> <path d="M22.4668 8.6169C22.297 8.09138 21.7016 7.85776 21.1936 8.07463C20.6857 8.29149 20.4525 8.87941 20.6116 9.40826C21.113 11.074 21.1224 12.8572 20.6271 14.5397C20.0373 16.5433 18.7684 18.2792 17.0383 19.4493C15.3082 20.6195 13.2247 21.1509 11.1455 20.9525C9.06631 20.754 7.121 19.8381 5.64348 18.3618C4.16596 16.8855 3.24838 14.9409 3.04821 12.8619C2.84804 10.7828 3.37778 8.69891 4.5465 6.96784C5.71522 5.23677 7.45004 3.96647 9.4532 3.37498C11.1353 2.8783 12.9184 2.88626 14.5846 3.38623C15.1136 3.54496 15.7013 3.31122 15.9178 2.80311C16.1342 2.29501 15.9001 1.69979 15.3744 1.53036C13.2759 0.853957 11.0142 0.821568 8.88488 1.4503C6.43471 2.17379 4.31277 3.72755 2.88325 5.84491C1.45373 7.96227 0.805783 10.5112 1.05062 13.0542C1.29545 15.5972 2.4178 17.9757 4.22503 19.7814C6.03225 21.5871 8.41165 22.7075 10.9548 22.9502C13.498 23.193 16.0464 22.5429 18.1626 21.1117C20.2788 19.6804 21.8308 17.5572 22.5523 15.1064C23.1792 12.9766 23.145 10.7148 22.4668 8.6169Z" fill="#ffffff"></path> <path d="M11.2944 9.35279L11.7105 9.14472C11.8435 9.07823 12 9.17493 12 9.32361V16C12 16.5523 12.4477 17 13 17C13.5523 17 14 16.5523 14 16V8C14 7.44772 13.5523 7 13 7H12.2361C12.0808 7 11.9277 7.03615 11.7888 7.10557L10.4944 7.75279C10.1914 7.9043 9.99999 8.214 9.99999 8.55279C9.99999 9.21769 10.6997 9.65014 11.2944 9.35279Z" fill="#ffffff"></path> </g></svg>
        </button>
    </div>
</div>

@code {

    private readonly Dictionary<string, string> _greetings = new()
    {
        { "hello (informal)", "привет" },
        { "hello (formal)", "здравствуйте" },
        { "excuse me", "извините"},
        { "please", "пожалуйста" },
        { "thank you", "спасибо" },
        { "good morning", "доброе утро" },
        { "good afternoon", "добрый день" },
        { "good evening", "добрый вечер" },
        { "goodnight", "спокойной ночи" },
        { "goodbye", "до свидания" }
    };

    private readonly Dictionary<string, string> _numbers = new()
    {
        { "1", "один" },
        { "2", "два" },
        { "3", "три" },
        { "4", "четыре" },
        { "5", "пять" },
        { "6", "шесть" },
        { "7", "семь" },
        { "8", "восемь" },
        { "9", "девять" },
        { "10", "десять" }
    };

    private Dictionary<string, string> _commonWords = new();
    
    private readonly Dictionary<string, IAudioPlayer> _audioPlayerCache = new ();

    protected override void OnInitialized()
    {
        _commonWords = _greetings;
    }
    
    private async Task PlayAudio(string word)
    {
        if (_audioPlayerCache.TryGetValue(word, out var value))
        {
            value.Play();
        }
        else
        {
            var file = await FileSystem.OpenAppPackageFileAsync($"wwwroot/sounds/words/{word}.m4a");
            var audioPlayer = AudioManager.CreatePlayer(file);

            audioPlayer.Play(); 
          
            _audioPlayerCache.Add(word, audioPlayer);
        }
    }
    
}